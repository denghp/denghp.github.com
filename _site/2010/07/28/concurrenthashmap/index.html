<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="content-language" content="en" />
    <meta name="robots" content="all,follow" />
    <title>ConcurrentHashMap原理分析 - 熊猫人Blog</title>
    <meta name="author" lang="en" content="All: Demi-Panda Lab [demi-panda.com]; e-mail: blog.pandam@gmail.com" />
    <meta name="copyright" lang="en" content="@2012 Demi_Panda Lab, All Rights Reserved!" />
    <meta name="description" content="熊猫人Blog主题：感想,敢拼,敢赢..." />
    <link rel="shortcut icon" href="/media/demi/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" media="screen,projection" type="text/css" href="/media/demi/css/style.css" />
    <link rel="stylesheet" media="screen,projection" type="text/css" href="/media/demi/css/main.css" />
    <link rel="stylesheet" media="screen,projection" type="text/css" href="/media/demi/css/reset.css" />
    <!--
    <link rel="stylesheet" media="screen,projection" type="text/css" href="/media/demi/css/embed.css" />
    -->
    <link rel="stylesheet" media="screen,projection" type="text/css" href="/media/demi/css/superfish.css" />
    <link rel="stylesheet" media="screen,projection" type="text/css" href="/media/demi/css/prettify.css" />
    <script src="/media/js/jquery-1.6.1.min.js" type="text/javascript"></script>
    <script src="/media/js/jquery.jcarousel.min.js" type="text/javascript"></script>
    <script src="/media/js/jquery.tagcloud.js" type="text/javascript"></script>
    <script src="/media/js/jquery.demi.slider.js" type="text/javascript"></script>

    <link rel="alternate" type="application/rss+xml" title="熊猫人Blog" href="/rss.xml" />
    <script type="text/javascript" src="http://static.duoshuo.com/js/common.js"></script>
    <script src="/media/js/prettify.js" type="text/javascript"></script>

    <script type="text/javascript">
      var duoshuoQuery = {short_name:"demi-panda"};
    </script>
    <script type="text/javascript" src="http://static.duoshuo.com/embed.js"></script>

      <script type="text/javascript">
      $(window).load(function(){
          $("pre").addClass("prettyprint");
          prettyPrint();
          })
        </script>

    <script language="javascript">
      $.fn.tagcloud.defaults = {
        size: {start: 0.9, end: 2, unit: 'em'},
        color: {start: '#e77471', end: '#f62817'}
      };

      $(function () {
        $('#tagcloud a').tagcloud();
      });
    </script>  
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36197302-1']);
      _gaq.push(['_trackPageview']);

      (function() {
       var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
       ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
       var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
       })();

     </script>
   </head>


   <body >

     <div id="wrapper">
       <!-- /header -->
<div id="header">

  <div id="logo">
    <h1 id="logo">
      <a href="/" title="[Go to homepage]"><img src="/media/demi/img/demi-logo-2.png" alt="" /></a>
    </h1> 
  </div><!-- /logo -->

  <div class="cleared"></div>
</div>
<!-- /header -->

 
       <!-- Tray -->
<div id="tray">
  <ul>
    <li ><a href="/">Home</a></li>
    <li ><a href="/archives/">文章列表</a></li>
    <li ><a href="/categories/">分类目录</a></li>
    <li ><a href="/life/">生活范儿</a></li>
    <li ><a href="/tags/">标签</a></li>
    <li ><a href="/about/">关于我</a></li>
  </ul>
  <hr class="noscreen" />                    
</div> 
<!-- /tray -->


       <div id="main">
         <div id="content">
  <div class="post type-post status-publish format-standard hentry category-1 post" >
    <div class="posttop">
      <h1 class="posttitle">
        ConcurrentHashMap原理分析
      </h1>
    </div>
    <div class="meta">
      Posted 
      <time class="text" datetime="2010-07-28">2010-07-28</time>&nbsp; |
      
      分类:
      
      
      <a href="/categories/#Programming" class="text" title="Programming" rel="category tag">Programming</a>&nbsp;
      
      
      &nbsp;&nbsp;

      <!-- Place this tag where you want the +1 button to render. -->
      <div class="g-plusone" data-size="medium" data-annotation="inline" data-width="200"></div>

      <!-- Place this tag after the last +1 button tag. -->
      <script type="text/javascript">
        window.___gcfg = {lang: 'zh-CN'};

(function() {
 var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
 po.src = 'https://apis.google.com/js/plusone.js';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
 })();
</script>
      
      <div class="tag">
        
        <a href="/tags/#Java" class="text" title="Java" rel="category tag">Java</a>&nbsp;
        
      </div>
      
    </div>

    <div class="postcontent-entry">
      <div class="cleared"></div>
      <h2>一.Java并发基础</h2>

<p>当一个对象或变量可以被多个线程共享的时候，就有可能使得程序的逻辑出现问题。
在一个对象中有一个变量i=0，有两个线程A，B都想对i加1，这个时候便有问题显现出来，关键就是对i加1的这个过程不是原子操作。要想对i进行递增，第一步就是获取i的值，当A获取i的值为0，在A将新的值写入A之前，B也获取了A的值0，然后A写入，i变成1，然后B也写入i，i这个时候依然是1.
当然java的内存模型没有上面这么简单，在Java Memory Model中，Memory分为两类，main memory和working memory，main memory为所有线程共享，working memory中存放的是线程所需要的变量的拷贝（线程要对main memory中的内容进行操作的话，首先需要拷贝到自己的working memory，一般为了速度，working memory一般是在cpu的cache中的）。volatile的变量在被操作的时候不会产生working memory的拷贝，而是直接操作main memory，当然volatile虽然解决了变量的可见性问题，但没有解决变量操作的原子性的问题，这个还需要synchronized或者CAS相关操作配合进行。</p>

<p>多线程中几个重要的概念:</p>

<h4>可见性</h4>

<p>也就说假设一个对象中有一个变量i，那么i是保存在main memory中的，当某一个线程要操作i的时候，首先需要从main memory中将i 加载到这个线程的working memory中，这个时候working memory中就有了一个i的拷贝，这个时候此线程对i的修改都在其working memory中，直到其将i从working memory写回到main memory中，新的i的值才能被其他线程所读取。从某个意义上说，可见性保证了各个线程的working memory的数据的一致性。
可见性遵循下面一些规则：</p>

<ul>
<li>当一个线程运行结束的时候，所有写的变量都会被flush回main memory中。</li>
<li>当一个线程第一次读取某个变量的时候，会从main memory中读取最新的。</li>
<li>volatile的变量会被立刻写到main memory中的，在jsr133中，对volatile的语义进行增强，后面会提到</li>
<li>当一个线程释放锁后，所有的变量的变化都会flush到main memory中，然后一个使用了这个相同的同步锁的进程，将会重新加载所有的使用到的变量，这样就保证了可见性。</li>
</ul>


<h4>原子性</h4>

<p>还拿上面的例子来说，原子性就是当某一个线程修改i的值的时候，从取出i到将新的i的值写给i之间不能有其他线程对i进行任何操作。也就是说保证某个线程对i的操作是原子性的，这样就可以避免数据脏读。
通过锁机制或者CAS（Compare And Set 需要硬件CPU的支持）操作可以保证操作的原子性。</p>

<h4>有序性</h4>

<p>假设在main memory中存在两个变量i和j，初始值都为0，在某个线程A的代码中依次对i和j进行自增操作（i，j的操作不相互依赖），</p>

<div class="highlight"><pre><code class="java"><span class="n">i</span><span class="o">++;</span>
<span class="n">j</span><span class="o">++;</span>
</code></pre>
</div>


<p>由于，所以i,j修改操作的顺序可能会被重新排序。那么修改后的ij写到main memory中的时候，顺序可能就不是按照i，j的顺序了，这就是所谓的reordering，在单线程的情况下，当线程A运行结束的后i，j的值都加1了，在线程自己看来就好像是线程按照代码的顺序进行了运行（这些操作都是基于as-if-serial语义的），即使在实际运行过程中，i，j的自增可能被重新排序了，当然计算机也不能帮你乱排序，存在上下逻辑关联的运行顺序肯定还是不会变的。但是在多线程环境下，问题就不一样了，比如另一个线程B的代码如下</p>

<div class="highlight"><pre><code class="java"><span class="k">if</span><span class="o">(</span><span class="n">j</span><span class="o">==</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
<span class="o">}</span>
</code></pre>
</div>


<p>按照我们的思维方式，当j为1的时候那么i肯定也是1，因为代码中i在j之前就自增了，但实际的情况有可能当j为1的时候i还是为0。这就是reordering产生的不好的后果，所以我们在某些时候为了避免这样的问题需要一些必要的策略，以保证多个线程一起工作的时候也存在一定的次序。JMM提供了happens-before 的排序策略。这样我们可以得到多线程环境下的as-if-serial语义。
这里不对happens-before进行详细解释了,详细的请看这里http://www.ibm.com/developerworks/cn/java/j-jtp03304/，这里主要讲一下volatile在新的java内存模型下的变化，在jsr133之前，下面的代码可能会出现问题</p>

<div class="highlight"><pre><code class="java"><span class="n">Map</span> <span class="n">configOptions</span><span class="o">;</span>
<span class="kt">char</span><span class="o">[]</span> <span class="n">configText</span><span class="o">;</span>
<span class="kd">volatile</span> <span class="kt">boolean</span> <span class="n">initialized</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="c1">// In Thread A</span>
<span class="n">configOptions</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>
<span class="n">configText</span> <span class="o">=</span> <span class="n">readConfigFile</span><span class="o">(</span><span class="n">fileName</span><span class="o">);</span>
<span class="n">processConfigOptions</span><span class="o">(</span><span class="n">configText</span><span class="o">,</span> <span class="n">configOptions</span><span class="o">);</span>
<span class="n">initialized</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
<span class="c1">// In Thread B</span>
<span class="k">while</span> <span class="o">(!</span><span class="n">initialized</span><span class="o">)</span> 
  <span class="n">sleep</span><span class="o">();</span>
<span class="c1">// use configOptions</span>
</code></pre>
</div>


<p>jsr133之前，虽然对 volatile 变量的读和写不能与对其他 volatile 变量的读和写一起重新排序，但是它们仍然可以与对 nonvolatile 变量的读写一起重新排序，所以上面的Thread A的操作，就可能initialized变成true的时候，而configOptions还没有被初始化，所以initialized先于configOptions被线程B看到，就产生问题了。</p>

<p>JSR 133 Expert Group 决定让 volatile 读写不能与其他内存操作一起重新排序，新的内存模型下，如果当线程 A 写入 volatile 变量 V 而线程 B 读取 V 时，那么在写入 V 时，A 可见的所有变量值现在都可以保证对 B 是可见的。</p>

<p>结果就是作用更大的 volatile 语义，代价是访问 volatile 字段时会对性能产生更大的影响。这一点在ConcurrentHashMap中的统计某个segment元素个数的count变量中使用到了。</p>

<h2>二.线程安全的HashMap</h2>

<p>什么时候我们需要使用线程安全的hashmap呢，比如一个hashmap在运行的时候只有读操作，那么很明显不会有问题，但是当涉及到同时有改变也有读的时候，就要考虑线程安全问题了，在不考虑性能问题的时候，我们的解决方案有Hashtable或者Collections.synchronizedMap(hashMap)，这两种方式基本都是对整个hash表结构做锁定操作的，这样在锁表的期间，别的线程就需要等待了，无疑性能不高。</p>

<h2>三.ConcurrentHashMap实现原理</h2>

<p>数据结构
ConcurrentHashMap的目标是实现支持高并发、高吞吐量的线程安全的HashMap。当然不能直接对整个hashtable加锁，所以在ConcurrentHashMap中，数据的组织结构和HashMap有所区别。</p>

<p>一个ConcurrentHashMap由多个segment组成，每一个segment都包含了一个HashEntry数组的hashtable，
每一个segment包含了对自己的hashtable的操作，比如get，put，replace等操作，这些操作发生的时候，对自己的hashtable进行锁定。由于每一个segment写操作只锁定自己的hashtable，所以可能存在多个线程同时写的情况，性能无疑好于只有一个hashtable锁定的情况。</p>

<p>源码分析
在ConcurrentHashMap的remove，put操作还是比较简单的，都是将remove或者put操作交给key所对应的segment去做的，所以当几个操作不在同一个segment的时候就可以并发的进行。</p>

<div class="highlight"><pre><code class="java">    <span class="kd">public</span> <span class="n">V</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">hash</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">());</span>
        <span class="k">return</span> <span class="nf">segmentFor</span><span class="o">(</span><span class="n">hash</span><span class="o">).</span><span class="na">remove</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">hash</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre>
</div>


<p>而segment中的remove操作除了加锁之外和HashMap中的remove操作基本无异。</p>

<div class="highlight"><pre><code class="java">        <span class="cm">/**</span>
<span class="cm">         * Remove; match on key only if value null, else match both.</span>
<span class="cm">         */</span>
        <span class="n">V</span> <span class="nf">remove</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">,</span> <span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">lock</span><span class="o">();</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
                <span class="n">HashEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;[]</span> <span class="n">tab</span> <span class="o">=</span> <span class="n">table</span><span class="o">;</span>
                <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">hash</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">tab</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
                <span class="n">HashEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">first</span> <span class="o">=</span> <span class="n">tab</span><span class="o">[</span><span class="n">index</span><span class="o">];</span>
                <span class="n">HashEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span>
                <span class="k">while</span> <span class="o">(</span><span class="n">e</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">!=</span> <span class="n">hash</span> <span class="o">||</span> <span class="o">!</span><span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">)))</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>

                <span class="n">V</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">V</span> <span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">value</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">v</span><span class="o">))</span> <span class="o">{</span>
                        <span class="n">oldValue</span> <span class="o">=</span> <span class="n">v</span><span class="o">;</span>
                        <span class="c1">// All entries following removed node can stay</span>
                        <span class="c1">// in list, but all preceding ones need to be</span>
                        <span class="c1">// cloned.</span>
                        <span class="o">++</span><span class="n">modCount</span><span class="o">;</span>
                        <span class="n">HashEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">newFirst</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
                        <span class="k">for</span> <span class="o">(</span><span class="n">HashEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">e</span><span class="o">;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">next</span><span class="o">)</span>
                            <span class="n">newFirst</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;(</span><span class="n">p</span><span class="o">.</span><span class="na">key</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">hash</span><span class="o">,</span>
                                                          <span class="n">newFirst</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="na">value</span><span class="o">);</span>
                        <span class="n">tab</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="n">newFirst</span><span class="o">;</span>
                        <span class="n">count</span> <span class="o">=</span> <span class="n">c</span><span class="o">;</span> <span class="c1">// write-volatile</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="k">return</span> <span class="n">oldValue</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
                <span class="n">unlock</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
</code></pre>
</div>


<p>上面的代码中关于volatile类型的变量count值得一提，这里充分利用了Java 5中对volatile语义的增强，count = c的操作必须在modCount，table等操作的后面，这样才能保证这些变量操作的可见性。
Segment类继承于ReentrantLock，主要是为了使用ReentrantLock的锁，ReentrantLock的实现比
synchronized在多个线程争用下的总体开销小。
put操作和remove操作类似。</p>

<p>接下来我们来看下get操作。</p>

<div class="highlight"><pre><code class="java">    <span class="kd">public</span> <span class="n">V</span> <span class="nf">get</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">hash</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">hashCode</span><span class="o">());</span>
        <span class="k">return</span> <span class="nf">segmentFor</span><span class="o">(</span><span class="n">hash</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">hash</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre>
</div>


<p>也是使用了对应的segment的get</p>

<div class="highlight"><pre><code class="java">       <span class="n">V</span> <span class="nf">get</span><span class="o">(</span><span class="n">Object</span> <span class="n">key</span><span class="o">,</span> <span class="kt">int</span> <span class="n">hash</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// read-volatile</span>
                <span class="n">HashEntry</span><span class="o">&lt;</span><span class="n">K</span><span class="o">,</span><span class="n">V</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">getFirst</span><span class="o">(</span><span class="n">hash</span><span class="o">);</span>
                <span class="k">while</span> <span class="o">(</span><span class="n">e</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">hash</span> <span class="o">==</span> <span class="n">hash</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">key</span><span class="o">))</span> <span class="o">{</span>
                        <span class="n">V</span> <span class="n">v</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">value</span><span class="o">;</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">v</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                            <span class="k">return</span> <span class="n">v</span><span class="o">;</span>
                        <span class="k">return</span> <span class="nf">readValueUnderLock</span><span class="o">(</span><span class="n">e</span><span class="o">);</span> <span class="c1">// recheck</span>
                    <span class="o">}</span>
                    <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
</code></pre>
</div>


<p>上面的代码中，一开始就对volatile变量count进行了读取比较，这个还是java5对volatile语义增强的作用，这样就可以获取变量的可见性。所以count != 0之后，我们可以认为对应的hashtable是最新的，当然由于读取的时候没有加锁，在get的过程中，可能会有更新。当发现根据key去找元素的时候，但发现找得的key对应的value为null，这个时候可能会有其他线程正在对这个元素进行写操作，所以需要在使用锁的情况下在读取一下value，以确保最终的值。</p>

<p>其他相关涉及读取的操作也都类似。</p>

    </div><!-- /postcontent -->

    <div class="v-pagination">
      
      <a class="prev" href="/2010/07/27/tomcat-upgrade" title="前一篇：Tomcat升级">&laquo; Tomcat升级</a>
      
      <!--
      <a class="center" href="/archives/">文章列表</a>
      -->
      
      <a class="next" href="/2010/07/31/advanced-linux-notes" title="后一篇：Linux培训笔记">Linux培训笔记 &raquo;</a>
      
    </div>
    <!-- JiaThis Button BEGIN -->
    <div class="jiathis_style" style="margin: 10px 10px 20px 0;padding: 10px 0 0;">
      <span class="jiathis_txt">分享到：</span>
      <a class="jiathis_button_tools_1"></a>
      <a class="jiathis_button_tools_2"></a>
      <a class="jiathis_button_tools_3"></a>
      <a class="jiathis_button_tools_4"></a>
      <a href="http://www.jiathis.com/share?uid=1706288" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
      <a class="jiathis_counter_style"></a>
    </div>
    <script type="text/javascript">
      var jiathis_config = {data_track_clickback:true};
    </script>
    <script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1343704647947962" charset="utf-8"></script>
    <!-- JiaThis Button END -->
  </div><!-- /post -->
  <div class="cleared"></div>

  <div class="archivesbox">
    <div class="comments">
      <!-- Duoshuo Comment Begin -->
      <div class="ds-thread" data-thread-id="20100728" data-thread-key="20100728" data-title="ConcurrentHashMap原理分析" data-url="/2010/07/28/concurrenthashmap"
        data-order="desc" data-form-positon="top"></div>
      <!-- Duoshuo Comment End -->
    </div>
  </div>
</div><!-- /content -->

<div id="sidebar">
  <ul>
    <li id="tag_cloud" class="boxed widget widget_tag_cloud">
    <h3 class="widgettitle">标签</h3>
    
      <a href='/tags/#Shell' class='tag-link-9' title='Shell' style='font-size: 15pt;'>Shell</a>
      
      <a href='/tags/#Jekyll' class='tag-link-1' title='Jekyll' style='font-size: 16pt;'>Jekyll</a>
      
      <a href='/tags/#CI' class='tag-link-1' title='CI' style='font-size: 12pt;'>CI</a>
      
      <a href='/tags/#Annotation' class='tag-link-1' title='Annotation' style='font-size: 20pt;'>Annotation</a>
      
      <a href='/tags/#Java' class='tag-link-6' title='Java' style='font-size: 14pt;'>Java</a>
      
      <a href='/tags/#prettify' class='tag-link-1' title='prettify' style='font-size: 18pt;'>prettify</a>
      
      <a href='/tags/#svn' class='tag-link-1' title='svn' style='font-size: 13pt;'>svn</a>
      
      <a href='/tags/#version' class='tag-link-1' title='version' style='font-size: 17pt;'>version</a>
      
      <a href='/tags/#HTTP' class='tag-link-1' title='HTTP' style='font-size: 14pt;'>HTTP</a>
      
      <a href='/tags/#OS' class='tag-link-1' title='OS' style='font-size: 12pt;'>OS</a>
      
      <a href='/tags/#Markdown' class='tag-link-1' title='Markdown' style='font-size: 18pt;'>Markdown</a>
      
      <a href='/tags/#Life' class='tag-link-1' title='Life' style='font-size: 14pt;'>Life</a>
      
      <a href='/tags/#Linux' class='tag-link-11' title='Linux' style='font-size: 15pt;'>Linux</a>
      
      <a href='/tags/#SSH' class='tag-link-2' title='SSH' style='font-size: 13pt;'>SSH</a>
      
      <a href='/tags/#Jenkins' class='tag-link-2' title='Jenkins' style='font-size: 17pt;'>Jenkins</a>
      
      <a href='/tags/#研发实践' class='tag-link-2' title='研发实践' style='font-size: 22pt;'>研发实践</a>
      
      <a href='/tags/#Hudson' class='tag-link-1' title='Hudson' style='font-size: 16pt;'>Hudson</a>
      
      <a href='/tags/#Python' class='tag-link-1' title='Python' style='font-size: 16pt;'>Python</a>
      
      <a href='/tags/#Ubuntu' class='tag-link-2' title='Ubuntu' style='font-size: 16pt;'>Ubuntu</a>
      
      <a href='/tags/#安全' class='tag-link-1' title='安全' style='font-size: 16pt;'>安全</a>
      
      <a href='/tags/#Github' class='tag-link-2' title='Github' style='font-size: 16pt;'>Github</a>
      
      <a href='/tags/#编程实践' class='tag-link-1' title='编程实践' style='font-size: 22pt;'>编程实践</a>
      
      <a href='/tags/#编程语言' class='tag-link-1' title='编程语言' style='font-size: 22pt;'>编程语言</a>
      
      <a href='/tags/#Mavne' class='tag-link-1' title='Mavne' style='font-size: 15pt;'>Mavne</a>
      
      <a href='/tags/#梦想' class='tag-link-1' title='梦想' style='font-size: 16pt;'>梦想</a>
      
      <a href='/tags/#HTML' class='tag-link-1' title='HTML' style='font-size: 14pt;'>HTML</a>
      
    </li>
    <li id="recent-posts-2" class="boxed widget widget_recent_entries">		
    <h3 class="widgettitle">近期文章</h3>	
    <ul>
       
      <li>
      <a href="/2012/11/22/version-manager" title="版本管理策略">版本管理策略</a>
      </li>
       
      <li>
      <a href="/2012/11/22/linux-find-practice" title="Linux find命令实践">Linux find命令实践</a>
      </li>
       
      <li>
      <a href="/2012/11/22/bash-profile" title=".bash_profile .bashrc profile 文件的作用的执行顺序">.bash_profile .bashrc profile 文件的作用的执行顺序</a>
      </li>
       
      <li>
      <a href="/2012/11/21/ssh-remote" title="SSH登陆响应慢的问题">SSH登陆响应慢的问题</a>
      </li>
       
      <li>
      <a href="/2012/11/21/http-status" title="HTTP状态码">HTTP状态码</a>
      </li>
       
      <li>
      <a href="/2012/11/20/ubunut-virtualbox" title="Ubuntu 中VirtualBox 使用U盾">Ubuntu 中VirtualBox 使用U盾</a>
      </li>
       
      <li>
      <a href="/2012/11/20/linux-ffmpeg" title="Linux下的命令行下转换媒体格式工具FFMPEG详解">Linux下的命令行下转换媒体格式工具FFMPEG详解</a>
      </li>
       
      <li>
      <a href="/2012/11/19/linux-command" title="程序员的利器-Linux常用命令">程序员的利器-Linux常用命令</a>
      </li>
       
      <li>
      <a href="/2012/11/19/jenkins-PermGen-Space" title="Jenkins PermGen space 问题">Jenkins PermGen space 问题</a>
      </li>
       
      <li>
      <a href="/2012/11/18/easybcd-win7-ubuntu" title="Win7 + Ubuntu12.04 + EasyDBC安装">Win7 + Ubuntu12.04 + EasyDBC安装</a>
      </li>
      
    </ul>
    </li>
    <li id="ds-top-threads" class="boxed widget ds-widget-top-threads">
    <h3 class="widgettitle">热评文章</h3>
    <ul class="ds-top-threads" data-num-items="5" data-range="weekly"></ul>
    </li>
    <li id="ds-recent-comments-3" class="boxed widget ds-widget-recent-comments">
    <h3 class="widgettitle">近期评论</h3>
    <ul class="ds-recent-comments" data-num-items="10" data-show-avatars="1" data-show-time="1" data-show-title="0" data-show-admin="0" data-avatar-size="32" data-excerpt-length="70">
    </ul>
    </li>
    <script>
      if (typeof DUOSHUO !== 'undefined')
      DUOSHUO.RecentCommentsWidget && DUOSHUO.RecentCommentsWidget('.ds-recent-comments');
    </script>
    <li id="ds-qqt-follow" class="boxed widget ds-widget-qqt-follow">
    <iframe src="http://follow.v.t.qq.com/index.php?c=follow&a=quick&name=denghp_280606790&style=1&t=1352387427769&f=1" frameborder="0" scrolling="auto" width="227" height="75" marginwidth="0" marginheight="0" allowtransparency="true"></iframe>
    </li>
    <li id="ds-recent-visitors-2" class="boxed widget ds-widget-recent-visitors">
    <h3 class="widgettitle">最近访客</h3>
    <ul class="ds-recent-visitors" data-num-items="21" data-show-time="0" data-avatar-size="50"></ul>
    </li>
    <script>
      if (typeof DUOSHUO !== 'undefined')
      DUOSHUO.TopThreads && DUOSHUO.TopThreads('.ds-top-threads');
    </script>
  </ul>
</div>
<!-- /sidebar -->
<div class="cleared"></div>





  

       </div> <!-- /main -->
     </div> <!-- wrapper -->

     <!-- footer -->
     <footer>
<div id="footer">                                          
  <p class="t-center" style='font-size: 10pt;'>
  &copy; 2012 <a href="/">Demi Panda Lab</a>, All Rights Reserved.
  <script src="http://s14.cnzz.com/stat.php?id=4734788&web_id=4734788&show=pic" language="JavaScript"></script>
  </p>
  </div> 
</footer>

 

   </body>
 </html>

